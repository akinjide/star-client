"use strict";(self["webpackChunkstar_client"]=self["webpackChunkstar_client"]||[]).push([[781],{9339:function(e,l,t){t.d(l,{A:function(){return g}});var a=t(6768),s=t(4232),o=t(2807),i=t(4189),r=t(697),n=t(3745),d=t(1772);const u={class:"pa-4 text-center"},c={class:"text-h6 font-weight-black"},p={class:"text-medium-emphasis"};function m(e,l,t,m,f,v){return(0,a.uX)(),(0,a.CE)("div",u,[(0,a.bF)(d.p,{"model-value":t.view,"max-width":"600",persistent:""},{default:(0,a.k6)((()=>[(0,a.bF)(i.J,{"prepend-icon":t.header.icon,title:t.header.title},{default:(0,a.k6)((()=>[(0,a.bF)(r.O,null,{default:(0,a.k6)((()=>[(0,a.Lk)("p",c,"Delete "+(0,s.v_)(t.body.name),1),(0,a.Lk)("div",p,(0,s.v_)(t.body.text),1)])),_:1}),(0,a.bF)(n.S,null,{default:(0,a.k6)((()=>[(0,a.bF)(o.D,{onClick:l[0]||(l[0]=e=>v.close(!t.view)),text:"Cancel"}),(0,a.bF)(o.D,{color:"red",onClick:l[1]||(l[1]=e=>v.confirm(!0)),text:"Confirm"})])),_:1})])),_:1},8,["prepend-icon","title"])])),_:1},8,["model-value"])])}var f={name:"DeleteDialog",props:{view:{type:Boolean,required:!0},header:{type:Object,required:!1,default:()=>({icon:"mdi-delete-alert-outline",title:"Confirm Delete"})},body:{type:Object,required:!1,default:()=>({name:"",text:"Are you sure you want to proceed?"})}},methods:{close(e){this.$emit("close",e)},confirm(e){this.$emit("confirm",e)}}},v=t(1241);const h=(0,v.A)(f,[["render",m]]);var g=h},8781:function(e,l,t){t.r(l),t.d(l,{default:function(){return R}});var a=t(6768),s=t(4232),o=t(3416),i=t(2807),r=t(4189),n=t(697),d=t(3745),u=t(1772),c=t(7511),p=t(8351),m=t(3813),f=t(6756),v=t(5526),h=t(1720),g=t(1286),b=t(3260),k=t(3948);const w={class:"d-flex justify-end align-center"},y={class:"mx-4"},F={class:"d-flex"},_={class:"pa-4 text-center"};function U(e,l,t,U,x,V){const C=(0,a.g2)("IconButton"),L=(0,a.g2)("DeleteDialog");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(m.I,{fluid:""},{default:(0,a.k6)((()=>[(0,a.bF)(f.L,null,{default:(0,a.k6)((()=>[(0,a.bF)(v.B,{cols:"4"},{default:(0,a.k6)((()=>l[17]||(l[17]=[(0,a.Lk)("h4",null,"Manage Users",-1)]))),_:1}),(0,a.bF)(v.B,{cols:"4"},{default:(0,a.k6)((()=>[(0,a.bF)(k.W,{"append-inner-icon":"mdi-magnify",density:"compact",label:"Search",variant:"underlined","hide-details":"","single-line":"",modelValue:x.searchQuery,"onUpdate:modelValue":l[0]||(l[0]=e=>x.searchQuery=e)},null,8,["modelValue"])])),_:1}),(0,a.bF)(v.B,{cols:"4"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",w,[(0,a.Lk)("h4",y,(0,s.v_)(V.usersCount)+" User(s)",1),(0,a.bF)(C,{tooltipText:"Add User",color:"blue",size:"small",icon:"mdi-account-edit-outline",onAction:l[1]||(l[1]=e=>V.select({},"create_user"))})])])),_:1})])),_:1}),(0,a.bF)(f.L,{class:"my-4"},{default:(0,a.k6)((()=>[(0,a.bF)(v.B,{cols:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(b.Z,{"fixed-header":""},{default:(0,a.k6)((()=>[l[18]||(l[18]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{class:"text-left text-uppercase"}),(0,a.Lk)("th",{class:"text-left text-uppercase"},"Full Name"),(0,a.Lk)("th",{class:"text-left text-uppercase"},"Title"),(0,a.Lk)("th",{class:"text-left text-uppercase"},"Email"),(0,a.Lk)("th",{class:"text-left text-uppercase"},"Role"),(0,a.Lk)("th",{class:"text-left text-uppercase"},"Department"),(0,a.Lk)("th",{class:"text-left text-uppercase"},"Actions")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(V.resultQuery,((l,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",null,[(0,a.bF)(o.y,{image:e.getImage(l.image)},null,8,["image"])]),(0,a.Lk)("td",null,(0,s.v_)(l.full_name),1),(0,a.Lk)("td",null,(0,s.v_)(l.title),1),(0,a.Lk)("td",null,(0,s.v_)(l.email),1),(0,a.Lk)("td",null,(0,s.v_)(e.getRoleName(l.role_id)),1),(0,a.Lk)("td",null,(0,s.v_)(l.department),1),(0,a.Lk)("td",null,[(0,a.Lk)("div",F,[(0,a.bF)(C,{tooltipText:"Edit User",color:"green",icon:"mdi-account-edit-outline",onAction:e=>V.select(l,"edit_user")},null,8,["onAction"]),(0,a.bF)(C,{tooltipText:"Remove User",color:"red",icon:"mdi-account-minus-outline",onAction:e=>V.select(l,"delete_user")},null,8,["onAction"])])])])))),128))])])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Lk)("div",_,[(0,a.bF)(u.p,{modelValue:x.dialog.value,"onUpdate:modelValue":l[15]||(l[15]=e=>x.dialog.value=e),"max-width":"600"},{default:(0,a.k6)((()=>[(0,a.bF)(r.J,{"prepend-icon":"mdi-account",title:x.dialog.title},{default:(0,a.k6)((()=>[(0,a.bF)(n.O,null,{default:(0,a.k6)((()=>[(0,a.bF)(f.L,{dense:""},{default:(0,a.k6)((()=>[(0,a.bF)(v.B,{cols:"12",md:"12",sm:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(k.W,{label:"Full name*",modelValue:x.selectedUser.full_name,"onUpdate:modelValue":l[2]||(l[2]=e=>x.selectedUser.full_name=e),required:"",rules:e.ruleMinMax("Full name",10,100)},null,8,["modelValue","rules"])])),_:1}),(0,a.bF)(v.B,{cols:"12",md:"6",sm:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(p.f,{accept:"image/png, image/jpeg, image/bmp",label:"Avatar",placeholder:"Pick an avatar","prepend-icon":"mdi-camera",modelValue:x.selectedUser.file,"onUpdate:modelValue":l[3]||(l[3]=e=>x.selectedUser.file=e),loading:x.progress},null,8,["modelValue","loading"])])),_:1}),(0,a.bF)(v.B,{cols:"12",md:"6",sm:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(k.W,{label:"Title",modelValue:x.selectedUser.title,"onUpdate:modelValue":l[4]||(l[4]=e=>x.selectedUser.title=e),rules:e.ruleMinMax("Title",-1,10,!0)},null,8,["modelValue","rules"])])),_:1}),(0,a.bF)(v.B,{cols:"12",md:"6",sm:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(k.W,{label:"Email*",modelValue:x.selectedUser.email,"onUpdate:modelValue":l[5]||(l[5]=e=>x.selectedUser.email=e),required:"",rules:e.ruleMinMax("Email",10,100)},null,8,["modelValue","rules"])])),_:1}),(0,a.bF)(v.B,{cols:"12",md:"6",sm:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(k.W,{label:"Department",modelValue:x.selectedUser.department,"onUpdate:modelValue":l[6]||(l[6]=e=>x.selectedUser.department=e),rules:e.ruleMinMax("Department",-1,100,!0)},null,8,["modelValue","rules"])])),_:1}),(0,a.bF)(v.B,{cols:"12",md:"6",sm:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(k.W,{label:"Student Number",modelValue:x.selectedUser.student_number,"onUpdate:modelValue":l[7]||(l[7]=e=>x.selectedUser.student_number=e)},null,8,["modelValue"])])),_:1}),(0,a.bF)(v.B,{cols:"12",md:"6",sm:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(g.d4,{items:e.getRoles,label:"Role*",modelValue:x.selectedUser.role_id,"onUpdate:modelValue":l[8]||(l[8]=e=>x.selectedUser.role_id=e),"item-title":"name","item-value":"id",required:"",rules:e.ruleRequired("Role")},null,8,["items","modelValue","rules"])])),_:1}),(0,a.bF)(v.B,{cols:"12",md:"6",sm:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(k.W,{label:x.dialog.password.label,"append-inner-icon":x.dialog.password.icon,type:x.dialog.password.type,"onClick:appendInner":l[9]||(l[9]=e=>V.togglePassword("password")),modelValue:x.selectedUser.password,"onUpdate:modelValue":l[10]||(l[10]=e=>x.selectedUser.password=e),required:"",rules:e.ruleRequired("Password",x.dialog.password.skip)},null,8,["label","append-inner-icon","type","modelValue","rules"])])),_:1}),(0,a.bF)(v.B,{cols:"12",md:"6",sm:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(k.W,{hint:"Password should match",label:x.dialog.nPassword.label,"append-inner-icon":x.dialog.nPassword.icon,type:x.dialog.nPassword.type,"onClick:appendInner":l[11]||(l[11]=e=>V.togglePassword("nPassword")),modelValue:x.selectedUser.confirm_password,"onUpdate:modelValue":l[12]||(l[12]=e=>x.selectedUser.confirm_password=e),required:"",rules:e.ruleRequired("Confirm Password",x.dialog.nPassword.skip),"persistent-hint":""},null,8,["label","append-inner-icon","type","modelValue","rules"])])),_:1})])),_:1}),l[19]||(l[19]=(0,a.Lk)("small",{class:"text-caption text-medium-emphasis"},"*indicates required field",-1))])),_:1}),(0,a.bF)(c.G),(0,a.bF)(d.S,null,{default:(0,a.k6)((()=>[(0,a.bF)(h.h),(0,a.bF)(i.D,{text:"Close",variant:"plain",onClick:l[13]||(l[13]=e=>x.dialog.value=!1)}),(0,a.bF)(i.D,{color:"primary",text:"Save",variant:"tonal",onClick:l[14]||(l[14]=e=>V.upsert(x.selectedUser))})])),_:1})])),_:1},8,["title"])])),_:1},8,["modelValue"])]),(0,a.bF)(L,{view:x.dialog.remove_user,body:{name:x.selectedUser.full_name,text:"Are you sure you want to proceed?"},onClose:l[16]||(l[16]=e=>x.dialog.remove_user=!1),onConfirm:V.remove},null,8,["view","body","onConfirm"])],64)}var x=t(5234),V=t(9339),C=t(7103),L=t(376),P=t(1175),A={name:"User Management",data(){return{dialog:{remove_user:!1,value:!1,title:"Add User",password:{label:"Password",icon:"mdi-eye-outline",type:"password",skip:!1},nPassword:{label:"Confirm password",icon:"mdi-eye-outline",type:"password",skip:!1}},searchQuery:null,selectedUser:{},progress:!1}},components:{IconButton:C.A,DeleteDialog:V.A},methods:{...(0,x.i0)(L.sk,["getUsers"]),...(0,x.i0)(L.sk,["createUser"]),...(0,x.i0)(L.sk,["updateUser"]),...(0,x.i0)(L.sk,["deleteUser"]),...(0,x.i0)(L.sk,["ruleRequired"]),...(0,x.i0)(L.sk,["ruleMinMax"]),select(e,l){"create_user"===l&&(this.dialog.title="Add User",this.dialog.password.label="Password",this.dialog.nPassword.label="Confirm password",this.dialog.password.skip=!1,this.dialog.nPassword.skip=!1,this.dialog.value=!0),"edit_user"===l&&(this.dialog.title="Edit User",this.dialog.password.label="Change password",this.dialog.nPassword.label="Confirm new password",this.dialog.password.skip=!0,this.dialog.nPassword.skip=!0,this.dialog.value=!0),"delete_user"===l&&(this.dialog.remove_user=!0),this.selectedUser={...e,action:l}},async upsert(e){if(e.file){const l=await P.A.upload.create(e.file,"images",(e=>{this.progress=!0}));this.progress=!1;const{data:{path:t}}=l.data;e.image=t}if("create_user"===e.action){const{errorMessage:l}=await this.createUser(e);l||(this.dialog=!1,this.$router.go(this.$router.currentRoute))}if("edit_user"===e.action){const{errorMessage:l}=await this.updateUser(e.id,e);l||(this.dialog=!1,this.$router.go(this.$router.currentRoute))}},async remove(e){if(e){const{errorMessage:e}=await this.deleteUser(this.selectedUser.id);e||this.$router.go(this.$router.currentRoute)}},togglePassword(e){if("password"===e){if("text"===this.dialog.password.type)return this.dialog.password.type="password",void(this.dialog.password.icon="mdi-eye-outline");this.dialog.password.type="text",this.dialog.password.icon="mdi-eye-off-outline"}if("nPassword"===e){if("text"===this.dialog.nPassword.type)return this.dialog.nPassword.type="password",void(this.dialog.nPassword.icon="mdi-eye-outline");this.dialog.nPassword.type="text",this.dialog.nPassword.icon="mdi-eye-off-outline"}}},async created(){await this.getUsers()},computed:{...(0,x.aH)(L.kH,["user"]),...(0,x.aH)(L.sk,["users"]),...(0,x.aH)(L.sk,["getRoleName"]),...(0,x.aH)(L.sk,["getRoles"]),...(0,x.aH)(L.sk,["getImage"]),usersCount(){return this.users?this.users.length:0},resultQuery(){return this.searchQuery?this.users.filter((e=>this.searchQuery.toLowerCase().split(" ").every((l=>!!e.full_name.toLowerCase().includes(l)||(!!e.department.toLowerCase().includes(l)||!!e.title.toLowerCase().includes(l)))))):this.users}}},B=t(1241);const I=(0,B.A)(A,[["render",U],["__scopeId","data-v-178010d1"]]);var R=I},8351:function(e,l,t){t.d(l,{f:function(){return b}});var a=t(6768),s=t(8995),o=t(1622),i=t(4577),r=t(5035),n=t(6935),d=t(1950),u=t(5296),c=t(2067),p=t(144),m=t(4587),f=t(9094),v=t(1247),h=t(4600);const g=(0,m.j)({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>"boolean"===typeof e||[1e3,1024].includes(Number(e))},...(0,r.V)({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>(0,f.BN)(e).every((e=>null!=e&&"object"===typeof e))},...(0,i.tG)({clearable:!0})},"VFileInput"),b=(0,v.RW)()({name:"VFileInput",inheritAttrs:!1,props:g(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,l){let{attrs:t,emit:m,slots:v}=l;const{t:g}=(0,u.Ym)(),b=(0,c.q)(e,"modelValue",e.modelValue,(e=>(0,f.BN)(e)),(l=>!e.multiple&&Array.isArray(l)?l[0]:l)),{isFocused:k,focus:w,blur:y}=(0,n.i)(e),F=(0,a.EW)((()=>"boolean"!==typeof e.showSize?e.showSize:void 0)),_=(0,a.EW)((()=>(b.value??[]).reduce(((e,l)=>{let{size:t=0}=l;return e+t}),0))),U=(0,a.EW)((()=>(0,f.hA)(_.value,F.value))),x=(0,a.EW)((()=>(b.value??[]).map((l=>{const{name:t="",size:a=0}=l;return e.showSize?`${t} (${(0,f.hA)(a,F.value)})`:t})))),V=(0,a.EW)((()=>{const l=b.value?.length??0;return e.showSize?g(e.counterSizeString,l,U.value):g(e.counterString,l)})),C=(0,p.KR)(),L=(0,p.KR)(),P=(0,p.KR)(),A=(0,a.EW)((()=>k.value||e.active)),B=(0,a.EW)((()=>["plain","underlined"].includes(e.variant)));function I(){P.value!==document.activeElement&&P.value?.focus(),k.value||w()}function R(e){P.value?.click()}function S(e){m("mousedown:control",e)}function D(e){P.value?.click(),m("click:control",e)}function E(l){l.stopPropagation(),I(),(0,a.dY)((()=>{b.value=[],(0,f.P)(e["onClick:clear"],l)}))}return(0,a.wB)(b,(e=>{const l=!Array.isArray(e)||!e.length;l&&P.value&&(P.value.value="")})),(0,h.C)((()=>{const l=!(!v.counter&&!e.counter),n=!(!l&&!v.details),[d,u]=(0,f.ph)(t),{modelValue:c,...p}=r.Z.filterProps(e),m=(0,i.jz)(e);return(0,a.bF)(r.Z,(0,a.v6)({ref:C,modelValue:b.value,"onUpdate:modelValue":e=>b.value=e,class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":B.value},e.class],style:e.style,"onClick:prepend":R},d,p,{centerAffix:!B.value,focused:k.value}),{...v,default:l=>{let{id:t,isDisabled:o,isDirty:r,isReadonly:n,isValid:d}=l;return(0,a.bF)(i.xR,(0,a.v6)({ref:L,"prepend-icon":e.prependIcon,onMousedown:S,onClick:D,"onClick:clear":E,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},m,{id:t.value,active:A.value||r.value,dirty:r.value||e.dirty,disabled:o.value,focused:k.value,error:!1===d.value}),{...v,default:l=>{let{props:{class:t,...i}}=l;return(0,a.bF)(a.FK,null,[(0,a.bF)("input",(0,a.v6)({ref:P,type:"file",readonly:n.value,disabled:o.value,multiple:e.multiple,name:e.name,onClick:e=>{e.stopPropagation(),n.value&&e.preventDefault(),I()},onChange:e=>{if(!e.target)return;const l=e.target;b.value=[...l.files??[]]},onFocus:I,onBlur:y},i,u),null),(0,a.bF)("div",{class:t},[!!b.value?.length&&!e.hideInput&&(v.selection?v.selection({fileNames:x.value,totalBytes:_.value,totalBytesReadable:U.value}):e.chips?x.value.map((e=>(0,a.bF)(s.x,{key:e,size:"small",text:e},null))):x.value.join(", "))])])}})},details:n?t=>(0,a.bF)(a.FK,null,[v.details?.(t),l&&(0,a.bF)(a.FK,null,[(0,a.bF)("span",null,null),(0,a.bF)(o.p,{active:!!b.value?.length,value:V.value,disabled:e.disabled},v.counter)])]):void 0})})),(0,d.O)({},C,L,P)}})},1720:function(e,l,t){t.d(l,{h:function(){return s}});t(5792);var a=t(2586);const s=(0,a.G)("v-spacer","div","VSpacer")}}]);
//# sourceMappingURL=781.6b73319c.js.map