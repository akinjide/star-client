"use strict";(self["webpackChunkstar_client"]=self["webpackChunkstar_client"]||[]).push([[824],{7103:function(e,t,o){o.d(t,{A:function(){return k}});var r=o(6768),n=o(2807),i=o(8856),s=o(1950),l=o(2067),a=o(2876),u=o(144),c=o(4587),p=o(9094),d=o(1247),f=o(7861),v=o(4600);const h=(0,c.j)({id:String,text:String,...(0,p.cJ)((0,i.D)({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),m=(0,d.RW)()({name:"VTooltip",props:h(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:o}=t;const n=(0,l.q)(e,"modelValue"),{scopeId:c}=(0,a.b)(),p=(0,f.v6)(),d=(0,r.EW)((()=>e.id||`v-tooltip-${p}`)),h=(0,u.KR)(),m=(0,r.EW)((()=>e.location.split(" ").length>1?e.location:e.location+" center")),g=(0,r.EW)((()=>"auto"===e.origin||"overlap"===e.origin||e.origin.split(" ").length>1||e.location.split(" ").length>1?e.origin:e.origin+" center")),y=(0,r.EW)((()=>e.transition?e.transition:n.value?"scale-transition":"fade-transition")),_=(0,r.EW)((()=>(0,r.v6)({"aria-describedby":d.value},e.activatorProps)));return(0,v.C)((()=>{const t=i.L.filterProps(e);return(0,r.bF)(i.L,(0,r.v6)({ref:h,class:["v-tooltip",e.class],style:e.style,id:d.value},t,{modelValue:n.value,"onUpdate:modelValue":e=>n.value=e,transition:y.value,absolute:!0,location:m.value,origin:g.value,persistent:!0,role:"tooltip",activatorProps:_.value,_disableGlobalStack:!0},c),{activator:o.activator,default:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return o.default?.(...r)??e.text}})})),(0,s.O)({},h)}});function g(e,t,o,i,s,l){return(0,r.uX)(),(0,r.Wv)(m,{text:o.tooltipText,location:"top"},{activator:(0,r.k6)((({props:i})=>[(0,r.bF)(n.D,(0,r.v6)({class:"mx-1",color:o.color,icon:o.icon,variant:"tonal",size:o.size},i,{onClick:t[0]||(t[0]=t=>e.$emit("action"))}),null,16,["color","icon","size"])])),_:1},8,["text"])}var y={name:"IconButton",props:{tooltipText:{type:String,required:!0},icon:{type:String,required:!0},size:{type:String,required:!1,default:"x-small"},color:{type:String,required:!0}}},_=o(1241);const b=(0,_.A)(y,[["render",g]]);var k=b},6866:function(e,t,o){o.d(t,{A:function(){return g}});var r=o(6768),n=o(4232),i=o(2807),s=o(4189),l=o(697),a=o(3745),u=o(1772);const c={class:"pa-4 text-center"},p={class:"text-h6 font-weight-black"},d={class:"text-medium-emphasis"};function f(e,t,o,f,v,h){return(0,r.uX)(),(0,r.CE)("div",c,[(0,r.bF)(u.p,{"model-value":o.view,"max-width":"600",persistent:""},{default:(0,r.k6)((()=>[(0,r.bF)(s.J,{"prepend-icon":o.header.icon,title:o.header.title},{default:(0,r.k6)((()=>[(0,r.bF)(l.O,null,{default:(0,r.k6)((()=>[(0,r.Lk)("p",p,(0,n.v_)(o.body.name),1),(0,r.Lk)("div",d,(0,n.v_)(o.body.text),1)])),_:1}),(0,r.bF)(a.S,null,{default:(0,r.k6)((()=>[o.body.url?((0,r.uX)(),(0,r.Wv)(i.D,{key:0,color:"orange",text:"Preview",href:o.body.url,target:"_blank"},null,8,["href"])):(0,r.Q3)("",!0),(0,r.bF)(i.D,{onClick:t[0]||(t[0]=e=>h.close(!o.view)),text:"Ok"})])),_:1})])),_:1},8,["prepend-icon","title"])])),_:1},8,["model-value"])])}var v={name:"PreviewDialog",props:{view:{type:Boolean,required:!0},header:{type:Object,required:!0},body:{type:Object,required:!0}},methods:{close(e){this.$emit("close",e)}}},h=o(1241);const m=(0,h.A)(v,[["render",f]]);var g=m},4012:function(e,t,o){o.r(t),o.d(t,{default:function(){return A}});var r=o(6768),n=o(4232),i=o(4189),s=o(1606),l=o(5832),a=o(3813),u=o(6756),c=o(5526),p=o(9669),d=o(9556),f=o(7254),v=o(7294),h=o(7505),m=o(3260);const g={key:0,class:"pa-4 my-2"},y={class:"d-flex"};function _(e,t,o,_,b,k){const w=(0,r.g2)("IconButton"),x=(0,r.g2)("PreviewDialog");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)(a.I,{fluid:""},{default:(0,r.k6)((()=>[(0,r.bF)(u.L,null,{default:(0,r.k6)((()=>[(0,r.bF)(c.B,{cols:"12"},{default:(0,r.k6)((()=>[t[1]||(t[1]=(0,r.Lk)("h4",{class:"text-uppercase"},"Report Templates",-1)),(0,r.bF)(d.x8,{lines:"two"},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(k.templates,((e,t)=>((0,r.uX)(),(0,r.Wv)(f.g,{key:t},{default:(0,r.k6)((()=>[(0,r.bF)(v.U,null,{default:(0,r.k6)((()=>[(0,r.eW)((0,n.v_)(e.title),1)])),_:2},1024),(0,r.bF)(h.w,{innerHTML:e.description},null,8,["innerHTML"])])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1}),(0,r.bF)(u.L,null,{default:(0,r.k6)((()=>[(0,r.bF)(c.B,{cols:"12"},{default:(0,r.k6)((()=>[t[4]||(t[4]=(0,r.Lk)("h4",{class:"text-uppercase mb-4"},"Report Submissions",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(k.resultQuery,((o,a)=>((0,r.uX)(),(0,r.Wv)(i.J,{key:a,elevation:"4",class:"pa-4 mb-6"},{default:(0,r.k6)((()=>[(0,r.bF)(s.r,null,{default:(0,r.k6)((()=>[(0,r.eW)((0,n.v_)(o.name)+" Report Submissions",1)])),_:2},1024),(0,r.bF)(l.Z,null,{default:(0,r.k6)((()=>[(0,r.eW)((0,n.v_)(k.getTeamSupervisor(o)),1)])),_:2},1024),k.teamReport(o.id).length?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",g,t[2]||(t[2]=[(0,r.Lk)("h6",{class:"text-h6 pa-4 font-weight-bold"},"Pending Reports",-1)]))),k.teamReport(o.id).length?((0,r.uX)(),(0,r.Wv)(m.Z,{key:1,class:"my-4"},{default:(0,r.k6)((()=>[t[3]||(t[3]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",{class:"text-left text-uppercase"},"Report Name"),(0,r.Lk)("th",{class:"text-left text-uppercase"},"Version"),(0,r.Lk)("th",{class:"text-left text-uppercase"},"Added"),(0,r.Lk)("th",{class:"text-left text-uppercase"},"Status"),(0,r.Lk)("th",{class:"text-left text-uppercase"},"Actions")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(k.teamReport(o.id),((t,o)=>((0,r.uX)(),(0,r.CE)("tr",{key:o},[(0,r.Lk)("td",null,(0,n.v_)(t.report_name),1),(0,r.Lk)("td",null,(0,n.v_)(t.report_version),1),(0,r.Lk)("td",null,(0,n.v_)(e.$parseDateTime(t.report_added_at)),1),(0,r.Lk)("td",null,[!k.isProgressReport(t)&&k.isSubmitted(t)?((0,r.uX)(),(0,r.Wv)(p.w,{key:0,color:"success",icon:"mdi-checkbox-marked-circle"})):(0,r.Q3)("",!0),k.isProgressReport(t)||k.isSubmitted(t)?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.Wv)(p.w,{key:1,color:"warning",icon:"mdi-clock-outline"}))]),(0,r.Lk)("td",null,[(0,r.Lk)("div",y,[k.isSubmitted(t)?((0,r.uX)(),(0,r.Wv)(w,{key:0,tooltipText:"Remove Report",color:"red",icon:"mdi-file-remove-outline",onAction:e=>k.remove(t)},null,8,["onAction"])):(0,r.Q3)("",!0),k.isSubmitted(t)?((0,r.uX)(),(0,r.Wv)(w,{key:1,tooltipText:"View Report",color:"blue-grey",icon:"mdi-file-eye-outline",onAction:e=>k.select(t,"view_report")},null,8,["onAction"])):(0,r.Q3)("",!0),k.isSubmitted(t)&&k.isReportURL(t)?((0,r.uX)(),(0,r.Wv)(w,{key:2,tooltipText:"Download Report",color:"orange",icon:"mdi-file-download-outline",onAction:e=>k.select(t,"download_report")},null,8,["onAction"])):(0,r.Q3)("",!0)])])])))),128))])])),_:2},1024)):(0,r.Q3)("",!0)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1}),(0,r.bF)(x,{view:b.dialog.view_report,header:{icon:"mdi-information",title:"Report Information"},body:{name:b.report.report_name,text:b.report.report_text,url:e.getDocument(b.report.report_url)},onClose:t[0]||(t[0]=e=>b.dialog.view_report=!1)},null,8,["view","body"])],64)}o(4114);var b=o(5234),k=o(7103),w=o(6866),x=o(376),R=o(3283),L=o(1175),S={name:"Report",data(){return{dialog:{view_report:!1,add_report:!1},searchQuery:null,progress:!1,maxProgressReport:8,report:{},submissions:[]}},components:{IconButton:k.A,PreviewDialog:w.A},methods:{...(0,b.i0)(x.sk,["getTeams"]),...(0,b.i0)(x.sk,["getTeamBySupervisor"]),...(0,b.i0)(x.sk,["getProjects"]),...(0,b.i0)(x.sk,["getReports"]),...(0,b.i0)(x.sk,["getProjectReports"]),...(0,b.i0)(x.sk,["getProjectByTeam"]),async select(e,t){"add_report"===t&&(this.progressReportCount=0,this.dialog.add_report=!0,this.report={...e,action:t}),"view_report"===t&&(this.report=e,this.dialog.view_report=!0),"download_report"===t&&e.report_url&&window.open(this.getDocument(e.report_url))},async upsert(e){if(e.file){const t=await L.A.upload.create(e.file,"documents",(e=>{this.progress=!0,console.log(Math.round(100*e.loaded/e.total))}));this.progress=!1;const{data:{path:o}}=t.data;e.url=o}if("add_report"===e.action){let t=1;e.name===R.Jc[2]&&(t=this.computeDedupe(this.projectReports));const o=await L.A.reports.create({...e,project_id:this.project.project_id,version:t});o&&o.data&&(console.log(o.data),this.dialog.add_report=!1,this.$router.go(this.$router.currentRoute))}},async remove(e){const t=await this.deleteReport(e.report_id);console.log(t),this.$router.go(this.$router.currentRoute)},isProgressReport(e){return e&&e.report_name===R.Jc[2]},isReportURL(e){return e&&e.report_url&&e.report_url.length},isReportText(e){return e&&e.report_text&&e.report_text.length},isSubmitted(e){return this.isReportText(e)||this.isReportURL(e)},computeDedupe(e){let t=1;if(e&&e.length)for(const o of e)o.report_name===R.Jc[2]&&t++;return t},teamReport(e){const t=[];if(this.reports&&this.reports.length)for(const o of this.reports)o.team_id===e&&t.push(o);return t},getTeamSupervisor(e){return e.supervisor_full_name?e.supervisor_title+" "+e.supervisor_full_name:"No supervisor assigned yet"}},async created(){await this.getTeams(),await this.getProjects(),await this.getReports()},computed:{...(0,b.aH)(x.kH,["user"]),...(0,b.aH)(x.sk,["teams"]),...(0,b.aH)(x.sk,["project"]),...(0,b.aH)(x.sk,["reports"]),...(0,b.aH)(x.sk,["projectReports"]),...(0,b.aH)(x.sk,["deleteReport"]),...(0,b.aH)(x.sk,["getDocument"]),reportProgress(){if(this.projectReports&&this.projectReports.length){const e=this.dedupeSubmissions.filter((e=>e.report_name===R.Jc[2]));return e.length}return 0},dedupeSubmissions(){const e=[],t=[];let o=this.submissions;if(this.projectReports&&this.projectReports.length){o=o.concat(this.projectReports);for(const r of o)e.push(r.report_name),t.push(r);for(const o of R.Jc)e.includes(o)||t.push({report_name:o})}return t},unsubmittedReports(){const e=[],t=[];let o=this.submissions,r=0;if(this.projectReports&&this.projectReports.length){o=o.concat(this.projectReports);for(const e of o)e.report_name===R.Jc[2]&&r++,t.push(e.report_name);for(const o of R.Jc)!e.includes(o)&&o===R.Jc[2]&&r<this.maxProgressReport&&e.push(o),t.includes(o)||e.push(o)}return e},resultQuery(){return this.searchQuery?this.teams.filter((e=>this.searchQuery.toLowerCase().split(" ").every((t=>!!e.name.toLowerCase().includes(t)||!!e.supervisor_full_name.toLowerCase().includes(t))))):this.teams},templates(){return R.QT}}},E=o(1241);const F=(0,E.A)(S,[["render",_],["__scopeId","data-v-a9f4b776"]]);var A=F},1772:function(e,t,o){o.d(t,{p:function(){return g}});var r=o(6768),n=o(6856),i=o(7852),s=o(8856),l=o(1950),a=o(2067),u=o(2876),c=o(144),p=o(4587),d=o(1247),f=o(9094),v=o(6993),h=o(4600);const m=(0,p.j)({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...(0,s.D)({origin:"center center",scrollStrategy:"block",transition:{component:n._},zIndex:2400})},"VDialog"),g=(0,d.RW)()({name:"VDialog",props:m(),emits:{"update:modelValue":e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(e,t){let{emit:o,slots:n}=t;const p=(0,a.q)(e,"modelValue"),{scopeId:d}=(0,u.b)(),m=(0,c.KR)();function g(e){const t=e.relatedTarget,o=e.target;if(t!==o&&m.value?.contentEl&&m.value?.globalTop&&![document,m.value.contentEl].includes(o)&&!m.value.contentEl.contains(o)){const e=(0,f.OW)(m.value.contentEl);if(!e.length)return;const o=e[0],r=e[e.length-1];t===o?r.focus():o.focus()}}function y(){o("afterEnter"),m.value?.contentEl&&!m.value.contentEl.contains(document.activeElement)&&m.value.contentEl.focus({preventScroll:!0})}function _(){o("afterLeave")}return v.ZK&&(0,r.wB)((()=>p.value&&e.retainFocus),(e=>{e?document.addEventListener("focusin",g):document.removeEventListener("focusin",g)}),{immediate:!0}),(0,r.wB)(p,(async e=>{e||(await(0,r.dY)(),m.value.activatorEl?.focus({preventScroll:!0}))})),(0,h.C)((()=>{const t=s.L.filterProps(e),o=(0,r.v6)({"aria-haspopup":"dialog"},e.activatorProps),l=(0,r.v6)({tabindex:-1},e.contentProps);return(0,r.bF)(s.L,(0,r.v6)({ref:m,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable},e.class],style:e.style},t,{modelValue:p.value,"onUpdate:modelValue":e=>p.value=e,"aria-modal":"true",activatorProps:o,contentProps:l,role:"dialog",onAfterEnter:y,onAfterLeave:_},d),{activator:n.activator,default:function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return(0,r.bF)(i.K,{root:"VDialog"},{default:()=>[n.default?.(...t)]})}})})),(0,l.O)({},m)}})},6856:function(e,t,o){o.d(t,{_:function(){return p}});var r=o(6768),n=o(5130),i=o(4587),s=o(1247),l=o(2419),a=o(1884),u=o(9886);const c=(0,i.j)({target:[Object,Array]},"v-dialog-transition"),p=(0,s.RW)()({name:"VDialogTransition",props:c(),setup(e,t){let{slots:o}=t;const i={onBeforeEnter(e){e.style.pointerEvents="none",e.style.visibility="hidden"},async onEnter(t,o){await new Promise((e=>requestAnimationFrame(e))),await new Promise((e=>requestAnimationFrame(e))),t.style.visibility="";const{x:r,y:n,sx:i,sy:s,speed:u}=f(e.target,t),c=(0,l.i)(t,[{transform:`translate(${r}px, ${n}px) scale(${i}, ${s})`,opacity:0},{}],{duration:225*u,easing:a.S8});d(t)?.forEach((e=>{(0,l.i)(e,[{opacity:0},{opacity:0,offset:.33},{}],{duration:450*u,easing:a.B2})})),c.finished.then((()=>o()))},onAfterEnter(e){e.style.removeProperty("pointer-events")},onBeforeLeave(e){e.style.pointerEvents="none"},async onLeave(t,o){await new Promise((e=>requestAnimationFrame(e)));const{x:r,y:n,sx:i,sy:s,speed:u}=f(e.target,t),c=(0,l.i)(t,[{},{transform:`translate(${r}px, ${n}px) scale(${i}, ${s})`,opacity:0}],{duration:125*u,easing:a.z3});c.finished.then((()=>o())),d(t)?.forEach((e=>{(0,l.i)(e,[{},{opacity:0,offset:.2},{opacity:0}],{duration:250*u,easing:a.B2})}))},onAfterLeave(e){e.style.removeProperty("pointer-events")}};return()=>e.target?(0,r.bF)(n.eB,(0,r.v6)({name:"dialog-transition"},i,{css:!1}),o):(0,r.bF)(n.eB,{name:"dialog-transition"},o)}});function d(e){const t=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list")?.children;return t&&[...t]}function f(e,t){const o=(0,u.Li)(e),r=(0,l.P)(t),[n,i]=getComputedStyle(t).transformOrigin.split(" ").map((e=>parseFloat(e))),[s,a]=getComputedStyle(t).getPropertyValue("--v-overlay-anchor-origin").split(" ");let c=o.left+o.width/2;"left"===s||"left"===a?c-=o.width/2:"right"!==s&&"right"!==a||(c+=o.width/2);let p=o.top+o.height/2;"top"===s||"top"===a?p-=o.height/2:"bottom"!==s&&"bottom"!==a||(p+=o.height/2);const d=o.width/r.width,f=o.height/r.height,v=Math.max(1,d,f),h=d/v||0,m=f/v||0,g=r.width*r.height/(window.innerWidth*window.innerHeight),y=g>.12?Math.min(1.5,10*(g-.12)+1):1;return{x:c-(n+r.left),y:p-(i+r.top),sx:h,sy:m,speed:y}}},9562:function(e,t,o){o.d(t,{Qo:function(){return v},SM:function(){return h},mM:function(){return d},QG:function(){return f}});var r=o(5130),n=o(6768),i=o(4587),s=o(1247);const l=(0,i.j)({disabled:Boolean,group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:String,origin:String},"transition");function a(e,t,o){return(0,s.RW)()({name:e,props:l({mode:o,origin:t}),setup(t,o){let{slots:i}=o;const s={onBeforeEnter(e){t.origin&&(e.style.transformOrigin=t.origin)},onLeave(e){if(t.leaveAbsolute){const{offsetTop:t,offsetLeft:o,offsetWidth:r,offsetHeight:n}=e;e._transitionInitialStyles={position:e.style.position,top:e.style.top,left:e.style.left,width:e.style.width,height:e.style.height},e.style.position="absolute",e.style.top=`${t}px`,e.style.left=`${o}px`,e.style.width=`${r}px`,e.style.height=`${n}px`}t.hideOnLeave&&e.style.setProperty("display","none","important")},onAfterLeave(e){if(t.leaveAbsolute&&e?._transitionInitialStyles){const{position:t,top:o,left:r,width:n,height:i}=e._transitionInitialStyles;delete e._transitionInitialStyles,e.style.position=t||"",e.style.top=o||"",e.style.left=r||"",e.style.width=n||"",e.style.height=i||""}}};return()=>{const o=t.group?r.F:r.eB;return(0,n.h)(o,{name:t.disabled?"":e,css:!t.disabled,...t.group?void 0:{mode:t.mode},...t.disabled?{}:s},i.default)}}})}function u(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"in-out";return(0,s.RW)()({name:e,props:{mode:{type:String,default:o},disabled:Boolean,group:Boolean},setup(o,i){let{slots:s}=i;const l=o.group?r.F:r.eB;return()=>(0,n.h)(l,{name:o.disabled?"":e,css:!o.disabled,...o.disabled?{}:t},s.default)}})}var c=o(4232);function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=t?"width":"height",r=(0,c.PT)(`offset-${o}`);return{onBeforeEnter(e){e._parent=e.parentNode,e._initialStyle={transition:e.style.transition,overflow:e.style.overflow,[o]:e.style[o]}},onEnter(t){const n=t._initialStyle;t.style.setProperty("transition","none","important"),t.style.overflow="hidden";const i=`${t[r]}px`;t.style[o]="0",t.offsetHeight,t.style.transition=n.transition,e&&t._parent&&t._parent.classList.add(e),requestAnimationFrame((()=>{t.style[o]=i}))},onAfterEnter:i,onEnterCancelled:i,onLeave(e){e._initialStyle={transition:"",overflow:e.style.overflow,[o]:e.style[o]},e.style.overflow="hidden",e.style[o]=`${e[r]}px`,e.offsetHeight,requestAnimationFrame((()=>e.style[o]="0"))},onAfterLeave:n,onLeaveCancelled:n};function n(t){e&&t._parent&&t._parent.classList.remove(e),i(t)}function i(e){const t=e._initialStyle[o];e.style.overflow=e._initialStyle.overflow,null!=t&&(e.style[o]=t),delete e._initialStyle}}a("fab-transition","center center","out-in"),a("dialog-bottom-transition"),a("dialog-top-transition");const d=a("fade-transition"),f=(a("scale-transition"),a("scroll-x-transition"),a("scroll-x-reverse-transition"),a("scroll-y-transition"),a("scroll-y-reverse-transition"),a("slide-x-transition"),a("slide-x-reverse-transition"),a("slide-y-transition")),v=(a("slide-y-reverse-transition"),u("expand-transition",p())),h=u("expand-x-transition",p("",!0))}}]);
//# sourceMappingURL=824.00eb3d3e.js.map